---
layout: post
title: "SSL 인증서를 이용한 정적 웹사이트 호스팅"
excerpt: ""
subtitle: "API docs"
toc: true
toc_sticky: true
toc_label: "페이지 주요 목차"
date: 2022-02-18
tags: [AWS, Route53, Cloudfront]
---

# SSL 인증서를 이용한 정적 웹사이트 호스팅 하기

Route53, ACM, CloudFront 서비스를 활용하여 https 배포를 진행 

## 📘 Menu

다음과 같은 순으로 CDN 배포 진행

1. Route53으로 도메인 지정
2. AWS Certificate Manager를 통한 SSL 발급
3. CloudFront에 인증서 적용

## 📘 Introduction

### Route53으로 도메인 지정

- 고객들이 [http://2bytescorp.com](http://2bytescorp.com/) 을 통해 웹 사이트를 방문할 수 있도록 AWS Route53을 이용해 해당 도메인을 등록
- Route53 - DNS 관리 - 호스팅 영역 생성 페이지로 이동하여 다음과 같이 입력 후 영역 생성
    
    
    ![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-062737.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-062737.png)
    

- 생성 후 다음과 같이 NS, SOA 유형의 레코드가 있는 것을 확인할 수 있음. NS 유형의 값/트래픽 라우팅 대상에 있는 4가지의 주소들을 기록

![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-064356.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-064356.png)

<aside>
💡 Record 종류
A : 도메인 주소와 서버의 IP 주소를 직접 매핑, 호스팅 중인 S3 연결 시 레코드명과 버킷명이 반드시 같아야 함!  
CNAME:  Canonical Name 약자로, 도메인 주소를 또 다른 도메인 주소로 매핑 (* alias)

</aside>

- 가비아, 닷네임 등과 같은 도메인 등록 사이트 내 네임서버 등록 페이지에 해당 레코드 값을 적는 칸이 있음. 맨 끝에 마침표는 빼고 기록한 4개의 주소를 기재

  

- DNS 변경 시, 수 시간 소요되며 터미널 창에 nslookup 명령어를 통해 변경 여부 확인
- [https://www.whatsmydns.net/](https://www.whatsmydns.net/) 에서 DNS 전파 과정 확인 가능

```bash
nslookup 도메인명
nslookup -type=ns 도메인명 
```

### **AWS Certificate Manager를 통한 SSL / TLS 발급**

<aside>
⚠️ **버지니아 북부(us-east-1)**로 리전 설정 후 인증서 요청

→  CloudFront와 같은 글로벌 CDN 서비스 이용 시, 인증서 사용이 가능해짐

</aside>

- SSL / TLS 인증서란? 클라이언트와 서버 간의 통신을 제 3자가 보증해주는 전자화 된 문서
- Certificate Manager**-** 인증서 프로비저닝 - 인증서 요청에서 공인 인증서 요청을 선택
- 퍼블릭 인증서 요청 내 Route53에 등록한 도메인 이름을 기재하고 DNS 검증을 선택

![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-073254.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-073254.png)

- 검증 요청 후, 인증서 개별 페이지 내 Route53에서 레코드 생성을 눌러 CNAME 레코드 추가
    
    → 도메인과 서브 도메인 각각 체크 후 CNAME 레코드 생성 진행 필요. 한번에 생성할 경우, 같은 CNAME 이름과 값이 할당되어 상기 DNS 검증이 이뤄지지 않음 (5/29)
    
    → [havah.io](http://havah.io) 도메인의 경우, 서브 도메인 생성이 되지 않아 접속 불가 이슈가 있었음
    → A 레코드도 생성 필요
    

![Untitled](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/Untitled.png)

- 인증서 검증에 필요한 시간은 최대 30분 정도 소요되며, 반드시 검증 완료 후 다음 단계로 이동

### Cloudfront에 인증서 적용

- 인증서 검증 후, Cloudfront - 배포 - 동작 생성 페이지로 진입하여 아래과 같이 값을 설정
- 캐싱은 S3(오리진) 에서 정적 파일을 받아 엣징 서버에 저장하는 캐시 데이터를 뜻하며, 전 세계 어느 곳에서 빠르게 당사 홈페이지 접속을 가능케 함
- 오리진에서 원본이 변경된 경우, CloudFront 에서는 이를 인지하고 S3에 원본 요청. 기본적으로 24시간(86,400초) 이후 변경된 내용이 캐시에 반영되며 이 주기는 legacy cache policy 내 TTL 설정으로 변경 가능
    
    
    ![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-075400.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-075400.png)
    
    ![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-075605.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-075605.png)
    

- 원본 도메인 항목에서는 다음과 같이 입력. 제일 하단에 표준 로깅과 IPv6는 모두 ‘끄기’로 설정
- 사용자 정의 SSL 인증서 항목에서는 전 단계에서 발급 받은 ACM 인증서를 선택

<aside>
⚠️ 기본값 루트 객체에는 index.html 기재 필요

</aside>

![SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-081756.png](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/image-20220113-081756.png)

- 다 완료되었다면 배포 생성 버튼을 누르고 status가 배포됨으로 바뀔 때까지 대기
    
    
- (+ 2/28) CloudFront- 배포 - 원본 - 편집에서 다음과 같이 **OAI 사용하기** 설정
    
    CloudFront가 S3 버킷에 접근할 수 있는 권한을  부여하는 중요 설정이므로 꼭 체크! 
    

 

![Untitled](SSL%20%E1%84%8B%E1%85%B5%E1%86%AB%E1%84%8C%E1%85%B3%E1%86%BC%E1%84%89%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A1%E1%86%AB%20%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%A8%20%E1%84%8B%E1%85%B0%E1%86%B8%E1%84%89%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%90%E1%85%B3%20%E1%84%92%E1%85%A9%E1%84%89%E1%85%B3%E1%84%90%E1%85%B5%E1%86%BC%20%20964a7479e2c34f74a54aec8cda3029a7/Untitled%201.png)

## 📋 **참조**

[[AWS] Amazon Certificate Manager로 HTTPS 적용해보기](https://devlog-wjdrbs96.tistory.com/293)

[HTTPS와 SSL 인증서 - 생활코딩](https://opentutorials.org/course/228/4894)

[AWS-Deploy-Practice](https://www.notion.so/AWS-Deploy-Practice-1d15f118f4014b08aced043188a9a7c7)

[원본 액세스 ID(OAI)를 사용하여 Amazon S3 콘텐츠에 대한 액세스 제한](https://docs.aws.amazon.com/ko_kr/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html)

[DNS에서 CNAME과 A 레코드의 차이](https://dev.plusblog.co.kr/30)
